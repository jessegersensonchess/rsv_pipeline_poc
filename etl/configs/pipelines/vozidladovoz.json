{
  "source": {
    "kind": "file",
    "file": {
      "path": "testdata/vozidladovoz.csv"
    }
  },
  "runtime": {
    "reader_workers": 1,
    "transform_workers": 4,
    "loader_workers": 1,
    "batch_size": 10000,
    "channel_buffer": 2048
  },
  "parser": {
    "kind": "csv",
    "options": {
      "has_header": true, "stream_scrub_likvidaci": true,
      "comma": ",",
      "trim_space": false,
      "expected_fields": 3,
      "header_map": {
        "PČV": "pcv",
        "Stát": "stat",
        "Datum dovozu": "datum_dovozu"
      }
    }
  },
  "transform": [
    {
      "kind": "coerce",
      "options": {
        "layout": "02.01.2006",
        "types": {
          "datum_dovozu": "date",
          "pcv": "int"
        }
      }
    },
    {
      "kind": "validate",
      "options": {
        "policy": "lenient",
        "contract": {
          "name": "vozidladovoz",
          "fields": [
            {
              "name": "pcv",
              "type": "int",
              "required": true
            },
            {
              "name": "stat",
              "type": "text"
            },
            {
              "name": "datum_dovozu",
              "type": "date",
              "layout": "02.01.2006"
            }
          ]
        }
      }
    }
  ],
  "storage": {
    "kind": "postgres",
    "postgres": {
      "dsn": "postgresql://user:password@0.0.0.0:5432/testdb?sslmode=disable",
      "table": "public.vozidladovoz",
      "columns": [
        "pcv",
        "stat",
        "datum_dovozu"
      ],
      "key_columns": ["pcv"],
      "auto_create_table": true
    }
  }
}
