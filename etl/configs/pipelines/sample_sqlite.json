{
  "source": {
    "kind": "file",
    "file": {
      "path": "testdata/vozidlavyrazenazprovozu.csv"
    }
  },
  "runtime": {
    "reader_workers": 1,
    "transform_workers": 1,
    "loader_workers": 1,
    "batch_size": 5000,
    "channel_buffer": 1000
  },
  "parser": {
    "kind": "csv",
    "options": {
      "has_header": true, "stream_scrub_likvidaci": true,
      "comma": ",",
      "trim_space": false,
      "expected_fields": 6,
      "header_map": {
        "PČV": "pcv",
        "Datum od": "datum_od",
        "Datum do": "datum_do",
        "Důvod": "duvod",
        "RM kód": "rm_kod",
        "RM Název": "rm_nazev"
      }
    }
  },
  "transform": [
    {
      "kind": "coerce",
      "options": {
        "layout": "02.01.2006",
        "types": {
          "datum_do": "date",
          "datum_od": "date",
          "pcv": "int"
        }
      }
    },
    {
      "kind": "validate",
      "options": {
        "policy": "lenient",
        "contract": {
          "name": "vozidlavyrazenazprovozu",
          "fields": [
            {
              "name": "pcv",
              "type": "int",
              "required": true
            },
            {
              "name": "datum_od",
              "type": "date",
              "layout": "02.01.2006"
            },
            {
              "name": "datum_do",
              "type": "date",
              "layout": "02.01.2006"
            },
            {
              "name": "duvod",
              "type": "text"
            },
           {
              "name": "rm_nazev",
              "type": "text"
            }
          ]
        }
      }
    }
  ],
  "storage": {
    "kind": "sqlite",
    "db": {
      "dsn": "file:etl.db?cache=shared&_fk=1",
      "table": "main.vozidlavyrazenazprovozu",
      "columns": [
        "pcv",
        "datum_od",
        "datum_do",
        "duvod",
        "rm_nazev"
      ],
      "key_columns": ["pcv"],
      "auto_create_table": true
    }
  }
}
