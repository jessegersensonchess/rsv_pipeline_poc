{{/* A minimal form to run the CSV sampler. */}}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>csvprobe — web</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica,Arial,sans-serif;line-height:1.35;margin:0;padding:0;background:#f7f7fb}
    .wrap{max-width:960px;margin:2rem auto;padding:0 1rem}
    .card{background:#fff;border-radius:14px;box-shadow:0 10px 25px rgba(0,0,0,.06);padding:1.25rem 1.5rem}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
    label{display:block;font-weight:600;margin:.25rem 0}
    input,select,textarea{width:100%;padding:.6rem .7rem;border:1px solid #d9dbe9;border-radius:10px;background:#fff}
    textarea{min-height:240px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    .row{margin:.75rem 0}
    .actions{display:flex;gap:.75rem;margin-top:1rem}
    .btn{background:#1f6feb;color:#fff;border:none;border-radius:10px;padding:.6rem 1rem;cursor:pointer}
    .btn.secondary{background:#6e7781}
    .muted{color:#6e7781;font-size:.9rem}
    .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>csvprobe — web</h1>
    <div class="card">
      <form method="POST" action="/probe">
        <div class="grid">
          <div>
            <div class="row">
              <label for="url">CSV URL</label>
              <input type="url" id="url" name="url" placeholder="https://example.com/test.csv" value="{{.URL}}" required>
            </div>
            <div class="row">
              <label for="name">Connector name</label>
              <input type="text" id="name" name="name" placeholder="technicke_prohlidky" value="{{.Name}}">
              <div class="muted">Used for file path/table/contract name (normalized).</div>
            </div>
            <div class="row">
              <label for="bytes">Bytes to sample</label>
              <input type="number" id="bytes" name="bytes" min="1000" step="1000" value="{{if .Bytes}}{{.Bytes}}{{else}}20000{{end}}">
            </div>
          </div>
          <div>
            <div class="row">
              <label for="delimiter">Delimiter</label>
              <input type="text" id="delimiter" name="delimiter" maxlength="1" value="{{if .Delimiter}}{{.Delimiter}}{{else}},{{end}}">
            </div>
            <div class="row">
              <label for="mode">Output</label>
              <select id="mode" name="mode">
                <option value="csv" {{if eq .Mode "csv"}}selected{{end}}>CSV (header,normalized,type)</option>
                <option value="json" {{if eq .Mode "json"}}selected{{end}}>JSON config</option>
              </select>
            </div>
            <div class="row">
              <label for="date_pref">Date preference</label>
              <select id="date_pref" name="date_pref">
                <option value="auto" {{if or (eq .DatePref "") (eq .DatePref "auto")}}selected{{end}}>Auto (DMY &gt; ISO &gt; MDY)</option>
                <option value="eu"   {{if eq .DatePref "eu"}}selected{{end}}>EU (prefer DMY)</option>
                <option value="us"   {{if eq .DatePref "us"}}selected{{end}}>US (prefer MDY)</option>
              </select>
              <div class="muted">Affects tie-breakers for ambiguous numeric dates like 02.01.2006.</div>
            </div>
          </div>
        </div>
        <div class="actions">
          <button class="btn" type="submit">Run</button>
          <a class="btn secondary" href="/" role="button">Reset</a>
          <a class="btn secondary" href="/api/probe?url={{.URL}}&name={{.Name}}&bytes={{.Bytes}}&delimiter={{.Delimiter}}&mode={{.Mode}}&date_pref={{.DatePref}}" role="button">API (GET)</a>
        </div>
      </form>
    </div>

    <div class="card" style="margin-top:1rem;">
      <div class="row">
        <label>Result</label>
        <textarea class="mono" readonly>{{.ResultText}}</textarea>
      </div>
    </div>

    <p class="muted">Tip: The API returns <span class="mono">text/plain</span> to make curl-ing easy.</p>
  </div>
</body>
</html>

